<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Circular Ruins</title>
    <link rel="stylesheet" href="./style.css">
    <style>
        #fluid-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 8;
            display: none;
            pointer-events: auto;
        }
        .content-box {
            position: relative;
            z-index: 10;
            background: transparent !important;
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <span class="nav-item" onclick="openOverlay('about')">About</span>
        <span class="nav-item" onclick="openOverlay('story')">Story</span>
        <span class="nav-item echoes-item" onclick="openOverlay('Echoes')">Echoes</span>
    </nav>

    <div class="contact-info">
        <a href="mailto:example@mail.com">xup184@newschool.edu</a>
        <a href="tel:+8612345678910">+1 917-698-1860</a>
    </div>

    <div id="main"></div>

    <div id="dial-page" class="dial-overlay">
        <div class="pointer-container">
            <div class="pointer-line"></div>
            <div class="pointer-dot"></div>
        </div>

        <div class="text-ring auto-rotate">
            <svg viewBox="0 0 500 500">
                <path id="circlePath1" d="M 250, 250 m -150, 0 a 150,150 0 1,1 300,0 a 150,150 0 1,1 -300,0" fill="none"></path>
                <text fill="#fff">
                    <textPath xlink:href="#circlePath1">
                        The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins· 
                    </textPath>
                </text>
            </svg>
        </div>

        <div class="text-ring auto-rotate-reverse">
            <svg viewBox="0 0 500 500">
                <path id="circlePath2" d="M 250, 250 m -190, 0 a 190,190 0 1,1 380,0 a 190,190 0 1,1 -380,0" fill="none"></path>
                <text fill="#fff">
                    <textPath xlink:href="#circlePath2">
                        The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins · The Circular Ruins· 
                    </textPath>
                </text>
            </svg>
        </div>
        <div id="wheel" class="wheel-container"></div>
    </div>

    <div id="overlay" class="overlay">
        <svg style="position: absolute; width: 0; height: 0; pointer-events: none;">
    <defs>
        <filter id="distort-filter" x="-50%" y="-50%" width="200%" height="1000%">
            <feTurbulence type="fractalNoise" baseFrequency="0.01 0.015" numOctaves="3" seed="2" result="noise">
                <animate attributeName="seed" from="1" to="100" dur="20s" repeatCount="indefinite" />
                <animate attributeName="baseFrequency" values="0.01 0.015; 0.012 0.02; 0.01 0.015" dur="10s" repeatCount="indefinite" />
            </feTurbulence>
            <feDisplacementMap in="SourceGraphic" in2="noise" scale="100" xChannelSelector="R" yChannelSelector="G" />
        </filter>
    </defs>
</svg>
        <span class="close-btn" onclick="closeOverlay()">&times;</span>
        <div id="global-story-link" class="static-story-link" onclick="openOverlay('story')">
        If you'd like to read the entire story more clearly, 
        <br><br>
        please click here...
    </div>

    <div id="overlay-content" class="content-box"></div>
</div>

    <canvas id="fluid-canvas"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/Blotter/0.1.0/blotter.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/Blotter/0.1.0/materials/liquidDistortMaterial.js'></script>

    <script type="x-shader/x-fragment" id="vertShader">
        precision highp float;
        attribute vec2 aPosition;
        varying vec2 vUv;
        varying vec2 vL; varying vec2 vR; varying vec2 vT; varying vec2 vB;
        uniform vec2 u_vertex_texel;
        void main () {
            vUv = aPosition * .5 + .5;
            vL = vUv - vec2(u_vertex_texel.x, 0.);
            vR = vUv + vec2(u_vertex_texel.x, 0.);
            vT = vUv + vec2(0., u_vertex_texel.y);
            vB = vUv - vec2(0., u_vertex_texel.y);
            gl_Position = vec4(aPosition, 0., 1.);
        }
    </script>

    <script type="x-shader/x-fragment" id="fragShaderAdvection">
        precision highp float; precision highp sampler2D;
        varying vec2 vUv;
        uniform sampler2D u_velocity_txr; uniform sampler2D u_input_txr;
        uniform vec2 u_vertex_texel; uniform float u_dt; uniform float u_dissipation;
        void main () {
            vec2 coord = vUv - u_dt * texture2D(u_velocity_txr, vUv).xy * u_vertex_texel;
            gl_FragColor = u_dissipation * texture2D(u_input_txr, coord);
        }
    </script>

    <script type="x-shader/x-fragment" id="fragShaderDivergence">
        precision highp float; precision highp sampler2D;
        varying vec2 vL; varying vec2 vR; varying vec2 vT; varying vec2 vB;
        void main () {
            float L = texture2D(u_velocity_txr, vL).x; float R = texture2D(u_velocity_txr, vR).x;
            float T = texture2D(u_velocity_txr, vT).y; float B = texture2D(u_velocity_txr, vB).y;
            gl_FragColor = vec4(0.5 * (R - L + T - B), 0., 0., 1.);
        }
    </script>

    <script type="x-shader/x-fragment" id="fragShaderPressure">
        precision highp float; precision highp sampler2D;
        varying vec2 vL; varying vec2 vR; varying vec2 vT; varying vec2 vB;
        uniform sampler2D u_pressure_txr; uniform sampler2D u_divergence_txr;
        void main () {
            float L = texture2D(u_pressure_txr, vL).x; float R = texture2D(u_pressure_txr, vR).x;
            float T = texture2D(u_pressure_txr, vT).x; float B = texture2D(u_pressure_txr, vB).x;
            float div = texture2D(u_divergence_txr, vUv).x;
            gl_FragColor = vec4((L + R + B + T - div) * 0.25, 0., 0., 1.);
        }
    </script>

    <script type="x-shader/x-fragment" id="fragShaderGradientSubtract">
        precision highp float; precision highp sampler2D;
        varying vec2 vL; varying vec2 vR; varying vec2 vT; varying vec2 vB;
        uniform sampler2D u_pressure_txr; uniform sampler2D u_velocity_txr;
        void main () {
            float L = texture2D(u_pressure_txr, vL).x; float R = texture2D(u_pressure_txr, vR).x;
            float T = texture2D(u_pressure_txr, vT).x; float B = texture2D(u_pressure_txr, vB).x;
            vec2 vel = texture2D(u_velocity_txr, vUv).xy;
            gl_FragColor = vec4(vel - vec2(R - L, T - B), 0., 1.);
        }
    </script>

    <script type="x-shader/x-fragment" id="fragShaderPoint">
        precision highp float;
        varying vec2 vUv;
        uniform sampler2D u_input_txr; uniform float u_ratio; uniform vec3 u_point_value; uniform vec2 u_point; uniform float u_point_size;
        void main () {
            vec2 p = vUv - u_point.xy; p.x *= u_ratio;
            vec3 splat = pow(2., -dot(p, p) / u_point_size) * u_point_value;
            gl_FragColor = vec4(texture2D(u_input_txr, vUv).xyz + splat, 1.);
        }
    </script>

    <script type="x-shader/x-fragment" id="fragShaderDisplay">
    precision highp float;
    precision highp sampler2D;
    varying vec2 vUv;
    uniform sampler2D u_output_texture;
    void main () {
        vec3 color = texture2D(u_output_texture, vUv).rgb;
        float strength = length(color);
        float alpha = smoothstep(0.01, 0.5, strength);
        gl_FragColor = vec4(color * 2.0, 1.0 - alpha); 
    }
</script>

    <script src="script.js"></script> 
</body>
</html>